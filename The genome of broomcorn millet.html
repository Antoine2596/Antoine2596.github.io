<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Charger les fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=PT+Serif&display=swap" rel="stylesheet">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preload" href="/static/fonts/HardingText-Regular-Web-cecd90984f.woff2" as="font" type="font/woff2" crossorigin="">
        <link rel="preconnect" href="https://push-content.springernature.io" crossorigin="">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
        <link href="https://fonts.googleapis.com/css2?family=Abhaya+Libre&display=swap" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Cantarell&display=swap" rel="stylesheet">

    <!-- CSS-->
    <link rel="stylesheet" href="The genome of broomcorn millet.css">
    <title>The genome of broomcorn millet</title>
    <!-- Icône de l'onglet -->
    <link rel="shortcut icon" href="Visu Données Omics/logo_AntoineGenomic.png">
</head>
<body>
    <header>
        <div class="navbar">
            <a href="#" class="logo">AntoineGenomic &#9816;</a>
            <div class="nav-links">
                <ul>
                    <li><a href="VisuOmics.html">Retourner dans le sommaire</a></li>
                    <li><a href="#">Version : 0.1</a></li>
                    <li><a href="#">A propos</a></li>
                </ul>
            </div>
        </div>
    </header>
    <div class="background">
        <img class="background_image" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41467-019-08409-5/MediaObjects/41467_2019_8409_Fig1_HTML.png?as=webp" alt="">
        <p class="background_text">The genome of broomcorn millet</p>
    </div>
<div class="bar_inferieur">
    <div class="contenu-bar_inferieur">
        <a href="https://www.nature.com/articles/s41467-019-08409-5">Accès à l'article</a>
        <a href="#1">Présentation du circos</a>
        <a href="#3">Accès au script</a>
    </div>
</div>
<div class="zone-script">
    <div class="texte-script">
        <h1 id="1">Présentation Circos</h1>
        <img class="img-script" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41467-019-08409-5/MediaObjects/41467_2019_8409_Fig1_HTML.png?as=webp" alt="">
        <p>Il s'agit d'un circos constitué de 6 tracks, il présente la synténie et distribution des caractéristiques dans le génome du millet à balais. Le nombre et la longueur (Mb) des pseudochromosomes sont indiqués à l'extérieur de l'anneau.</p>
        <h2>Piste a</h2>
        <p>Il s'agit d'une heatmap représentant le taux de couverture TE.</p>
        <img class="petit-img-script"src="Visu Données Omics/Circos3/figA.png" alt="">
        <h2>Piste b</h2>
        <p>Il s'agit également d'une heatmap, cette fois-ci de la densité de gène dans chaque région de chromosome.</p>
        <img class="petit-img-script" src="Visu Données Omics/Circos3/figB.png" alt="">
        <h2>Piste c</h2>
        <p>C'est une linetrack, c'est à dire d'une courbe dont la hauteur dépend du niveau moyen de gène transcrit.</p>
        <img class="petit-img-script" src="Visu Données Omics/Circos3/FigC.png" alt="">
        <h2>Piste d</h2>
        <p>La piste d est un histogramme, représentant la densité de marqueurs représentés par le nombre de SNP (<em>Single Nucleotide Polymorphism</em>).</p>
        <img class="petit-img-script" src="Visu Données Omics/Circos3/FigD.png" alt="">
        <h2>Piste e</h2>
        <p>Il s'agit d'une linetrack présentant la teneur en GC (guanine-cytosine) du génome dans des fenêtres non superposées de 1 Mb.</p>
        <img class="petit-img-script" src="Visu Données Omics/Circos3/FigE.png" alt="">
        <h2>Piste f</h2>
        <p>Enfin, la piste F est une linktrack, chaques liens représentent les blocs de synténie > 1 Mb de long parmi les chromosomes homologues du millet à balai sont indiqués.</p>
        <img class="petit-img-script" src="Visu Données Omics/Circos3/FigF.png" alt="">
        <h1 id="2">Présentation des données</h1>
        <p>Toutes les données nécessaires sont disponible sur le site de l'article, disponible en cliquant <a href="https://www.nature.com/articles/s41467-019-08409-5"><strong>ici</strong></a>.</p>
        <h2>Piste a,b,c,d,e</h2>
        <!-- https://www.jqueryscript.net/table/advanced-interactive-data-table.html -->
        <p>Les pistes a,b,c,d et e ont toutes la même structure, ce sont des tableaux constitué de 4 colonnes :
            <ul>
                <li>La colonne <strong>chromosome</strong> : le nom du chromosome dont se situe la région</li>
                <li>La colonne <strong>Start</strong> : position du premier nucleotide de la région</li>
                <li>La colonne <strong>End</strong> : position du dernier nucleotide de la région</li>
                <li>Une quatrième et dernière colonne dont le nom varie entre les différents onglets <strong>(a)</strong> à <strong>(e)</strong>, elle présente la valeur des différentes caractéristiques de la région.</li>
            </ul>
            La structure des tableaux peut être parfaitement lu par les fonctions de <strong>'BioCircos'</strong>, ainsi aucun modification sera nécéssaire.
        </p>
        <!-- menu déroulant des différents tableaux -->
        <select id="tableSelector">
            <option value="Visu-omic tableau-article/table-article3-fig-1a.html">Tableau a</option>
            <option value="Visu-omic tableau-article/table-article3-fig-1b.html">Tableau b</option>
            <option value="Visu-omic tableau-article/table-article3-fig-1c.html">Tableau c</option>
            <option value="Visu-omic tableau-article/table-article3-fig-1d.html">Tableau d</option>
            <option value="Visu-omic tableau-article/table-article3-fig-1e.html">Tableau e</option>
          </select>
          <div class="iframe" id="tableContainer"></div>
          <script src="Visu-omic tableau-article/tableau-article.js"></script>
        <h2>Piste f</h2>
        <p>La piste <strong>(f)</strong>, représentant les différents synténies sous forme de lien inter-chromosomique, provient de ce tableau:</p>
        <p>Le tableau contient 4 colonnes :
            <ul>
                <li>La colonne <strong>Links</strong>: le nom du lien.</li>
                <li>La colonne <strong>Chromosome</strong> : le nom du chromosome auquel appartient le lien.</li>
                <li>La colonne <strong>Start</strong> : début de la région d'où commence le lien.</li>
                <li>La colonne <strong>End</strong> : fin de position de la région d'où commence de lien.</li>
            </ul></p>
            
              <iframe class="iframe" src="Visu-omic tableau-article/table-article3-fig-1f.html" width="100%" height="500"></iframe>
            
              
           <p> Le tableau n'est pas adapté pour être lu par <strong>'BioCircos'</strong>, il sera nécessaire d'apporter des modification afin d'arranger le tableau.</p>
        
        <h1 id="3">Présentation du script</h1>
        <h2 id="4">Les librairies</h2>
        <p>En premier temps, nous allons charger tous les packages nécéssaires au bon fonctionnement du script.</p>
        <code>
            <div class="script">
            #Installer le package une seule fois  <br>
install.packages("BioCircos") <br>
 <br>
library(readxl) # Permet de lire les fichiers .xls <br>
library(BioCircos) #Permet d'afficher des valeurs sous forme de circos <br>
library(RColorBrewer) #Librairie les couleurs <br>
</div>        
</code>
        
        <h2 id="5">Lecture des données</h2>
        <p>Nous allons charger les différents tableau issue du fichier <strong>41467_2019_8409_MOESM5_ESM</strong> avec la fonction <strong><em>'read_excel'</em></strong>, chaque onglet correspondant à une piste, nous allons utiliser le paramètre <em><strong>'sheet'</strong></em> afin de sélectionner l'onget du fichier que nous allons associer à un objet :</p>
        <code><div class="script">
            #Lecture des données<br>
pisteA <- read_excel("41467_2019_8409_MOESM5_ESM.xlsx",  <br>
                     sheet = 1, #sheet : numéro de l'onglet à sélectionner<br>
                     skip = 0)  #skip = 1 : permet de sauter la première ligne qui contient des informations inutiles<br>
pisteB <- read_excel("41467_2019_8409_MOESM5_ESM.xlsx", sheet = 2, skip = 0)<br>
pisteC <- read_excel("41467_2019_8409_MOESM5_ESM.xlsx", sheet = 3, skip = 0)<br>
pisteD <- read_excel("41467_2019_8409_MOESM5_ESM.xlsx", sheet = 4, skip = 0)<br>
pisteE <- read_excel("41467_2019_8409_MOESM5_ESM.xlsx", sheet = 5, skip = 0)<br>
pisteF <- read_excel("41467_2019_8409_MOESM5_ESM.xlsx", sheet = 6, skip = 0)<br>
        </div></code>
        <h3>Arrangement de la piste f</h3>
        <p>Comme vu précédemment, le tableau <strong>(f)</strong> n'a pas une structure adapté à <strong>'BioCircos'</strong>, il faut donc s'arranger afin que ce tableau ait une structure de ce genre :
        <ul>
            <li>Une colonne <strong>Chromosome A</strong> :Le nom du chromosome de la région d'où part le lien.</li>
        <li>Une colonne <strong>Start A</strong>: La position de départ de la région d'où part le lien.</li>
        <li>Une colonne <strong>End A</strong> : La position de fin d'où part le lien.</li>
        <li>Une colonne <strong>Chromosome B</strong> : Le nom du chromosome de la région d'où arrive le lien.</li>
        <li>Une colonne <strong>Start B</strong> : La position de départ de la région d'où arrive.</li>
        <li>Une colonne <strong>End B</strong> : La position de fin d'où arrive.</li></ul>
    Pour cela, nous allons modifier le tableau étape par étape afin de l'adapter :</p>
    <p>En premier temps, nous allons séparer les lignes de chaque même links, en effet chaque link apparait 2 fois, il s'agit en vérité du même lien, le lien impair représente les caractéristique de la région du chromosome A, tandis que la ligne pair représente les caractéristiques du chromosome B, nous allons donc séparer les lignes afin d'en faire des colonnes.</p>
    <div class="script"><code># Filtrer les indices de lignes impairs<br>
        indices_impairs <- seq(1, nrow(pisteF), by = 2)<br>
        <br>
        # Supprimer les lignes impaires du tableau<br>
        ChrA <- pisteF[indices_impairs, ]<br>
        <br>
        # Filtrer les indices de lignes pairs<br>
        indices_pairs <- seq(2, nrow(pisteF), by = 2)<br>
        <br>
        # Supprimer les lignes paires du tableau<br>
        ChrB <- pisteF[indices_pairs, ]<br>
        <br>
        #On fusionne les tableaux en fonction de leur colonne commune "Links"<br>
        pisteF <- merge(ChrA, ChrB, by = "Links")</code></div> 
        <h2 id="6">Construction du circos</h2>
        <h3>Construction des chromosomes du circos</h3>
        <div class="script"><code># On créer une liste contenant les noms et longueur des chromosomes<br>
            MyGenome <- list("PmChr01" =66884923,<br>
                             "PmChr03" =58436902,<br>
                             "PmChr05" =56934218,<br>
                             "PmChr07" =54759544,<br>
                             "PmChr09" =51032733,<br>
                             "PmChr11" =49540115,<br>
                             "PmChr13" =46661915,<br>
                             "PmChr15" =39901388,<br>
                             "PmChr17" =39340074,<br>
                             "PmChr18" =32167407,<br>
                             "PmChr16" =34515715,<br>
                             "PmChr14" =33171554,<br>
                             "PmChr12" =42378805,<br>
                             "PmChr10" =31649554,<br>
                             "PmChr08" =43632214,<br>
                             "PmChr06" =43720407,<br>
                             "PmChr04" =43575051,<br>
                             "PmChr02" =53821721
              
            )<br>
            <br>
            # On créer un titre<br>
            Track <- BioCircosTextTrack("MyTextTrack","The genome of broomcorn millet",<br>
                                        x = -0.9,y=-1.4, size = "1.5em")</code></div>
        <h3>pistes a et b</h3>
        <p>Les pistes <strong>(a)</strong> et <strong>(b)</strong> peuvent être réalisées à partir de la fonction <strong>'BioCircosHeatmapTrack'</strong>, en lui donnant le nom du chromosome de la région, le début de la région, la fin de la région, et la valeur de la région.</p>
        <code><div class="script"># Créer la heatmap de la piste A<br>
            Track <- Track + BioCircosHeatmapTrack("pisteA", labels = FALSE,<br>
                                                   chromosomes= pisteA$Chromosome,<br>
                                                   starts = pisteA$Start,<br>
                                                   ends = pisteA$End,<br>
                                                   values = pisteA$`TE content (%)`,<br>
                                                   maxRadius = 1.15,<br>
                                                   minRadius = 1.05,<br>
                                                   color =c("#fdebdd","#d95615"),<br>
                                                   range = 0)<br>
                                                   <br>
            # Créer la heatmap de la piste B<br>
            Track <- Track + BioCircosHeatmapTrack("pisteB", labels = FALSE,<br>
                                                   chromosomes = pisteB$Chromosome,<br>
                                                   starts = pisteB$Start,<br>
                                                   ends = pisteB$End,<br>
                                                   values = pisteB$`Gene Number`,<br>
                                                   maxRadius = 1.03,<br>
                                                   minRadius = 0.93,<br>
                                                   color =c("#f0eff2","#367baf"),<br>
                                                   range = 0)</div></code>
        <h3>piste c et e</h3>
        <p>Les pistes <strong>(c)</strong> et <strong>(e)</strong> peuvent être réalisées à partir de la fonction <strong>'BioCircosLineTrack'</strong>, en lui donnant les mêmes instructions que pour la heatmap.</p>
        <code><div class="script"># Créer une track de lien de la piset C
            Track <- Track + BioCircosLineTrack("pisteC",<br>
                                                chromosomes = pisteC$Chromosome, <br>
                                                positions = pisteC$End,<br>
                                                values = pisteC$`Transcriptional level (Log2 (RPKM))`,<br>
                                                maxRadius = 0.925,<br>
                                                minRadius = 0.825,<br>
                                                color = "#e46a53",<br>
                                                width = 0.5)<br>
                                                <br>
                                                # Réaliser la piste E<br>
                                                Track <- Track + BioCircosLineTrack("pisteE",<br>
                                                                                    chromosomes = pisteE$Chromosome, <br>
                                                                                    positions = pisteE$End,<br>
                                                                                    values = pisteE$`GC content （%）`,<br>
                                                                                    maxRadius = 0.725,<br>
                                                                                    minRadius = 0.675,<br>
                                                                                    color = "#8babbb",<br>
                                                                                    width = 0.5)<br>
                                                </div></code>
        
        <h3>piste d</h3>
        <p>La piste <strong>(d)</strong> peut être réalisé à partir de la fonction <strong>'BioCircosBarTrack'</strong>.</p>
        <code><div class="script">#Mettre en log les valeurs<br>
            pisteD$`SNP density` <- log(pisteD$`SNP density`)<br>
            #Remplacer les valeurs -Inf par 0<br>
            pisteD$`SNP density`[pisteD$`SNP density` == "-Inf"] <- 0<br>
            <br>
            # Réaliser la piste D<br>
            Track <- Track + BioCircosBarTrack("pisteD",<br>
                                               chromosomes = pisteD$Chromosome,<br>
                                               starts = pisteD$Start,<br>
                                               ends = pisteD$End,<br>
                                               values = pisteD$`SNP density`,<br>
                                               labels = FALSE,<br>
                                               maxRadius = 0.80,<br>
                                               minRadius = 0.75,<br>
                                               color = "#94549c",<br>
                                               range = 0)</div></code>
        <p>Nous avons volontairement modifier la taille des SNP afin qu'il soient visible sur le circos.</p>
        <h3>piste f</h3>
        <p>Pour réaliser la piste <strong>(f)</strong>, on commence par définir un tableau représentant une palette de couleur précise, dont chaque couleur correspondent a un chromosome :</p>
        <p>On peut ensuite créer une boucle afin d'afficher la couleur de chaque lien, avec la fonction <strong>'BioCircosLinkTrack'</strong>.</p>
        <code><div class="script"># Créer des couleurs<br>
            #Créer une liste contenant le nom des chromosomes<br>
            Chromosome <- c("PmChr01","PmChr02","PmChr03","PmChr04",<br>"PmChr05","PmChr06","PmChr07","PmChr08",<br>
                            "PmChr09","PmChr10","PmChr11","PmChr12",<br>"PmChr13","PmChr14","PmChr15","PmChr16",<br>"PmChr17","PmChr18")<br>
            # Créer une liste contenant une couleur<br>
            Couleurs <- c(<br>
                       "#19b2d7",<br>
                       "#19b2d7",<br>
                       "#c1d62f",<br>
                       "#c1d62f",<br>
                       "#f2c51c",<br>
                       "#f2c51c",<br>
                       "#ebea39",<br>
                       "#ebea39",<br>
                       "#ceebf1",<br>
                       "#ceebf1",<br>
                       "#b34e99",<br>
                       "#b34e99",<br>
                       "#c4e8ff",<br>
                       "#c4e8ff",<br>
                       "#688ec8",<br>
                       "#688ec8",<br>
                       "#72c6d7",<br>
                       "#72c6d7"
            )<br>
            <br>
            # On créer un tableau à partir des 2 listes<br>
            table_couleurs <- data.frame(Chromosome,Couleurs)<br>
            <br>
            # On renomme le nom des lignes par les cases de la première colonne<br>
            rownames(table_couleurs) <- table_couleurs$Chromosome<br>
            <br>
            #On définit une variable "NomPn" qui va nous permettre d'ajuster la couleur dans la boucle<br>
            NomPn <- 1<br>
            # Boucle qui affiche liens avec leur couleurs associées<br>
            for (i in 1:311){ <br>
              Track <- Track + BioCircosLinkTrack("pisteF",<br>
                                                  pisteF$Chromosome.x[i],<br>
                                                  pisteF$Start.x[i],<br>
                                                  pisteF$End.x[i],<br>
                                                  pisteF$Chromosome.y[i],<br>
                                                  pisteF$Start.y[i],<br>
                                                  pisteF$End.y[i], <br>
                                                  maxRadius = 0.65, <br>
                                                  NomPn <- pisteF$Chromosome.y[i],<br>
                                                  color = table_couleurs[NomPn,2],displayLabel = FALSE ,width = 2)q
              
            }</div></code>
        <h3>Ajout des annotations</h3>
        <p>Il est possible enfin d'ajouter des annotations correspondant à chaque piste.</p>
        <code><div class="script"># Créer un fond de couleur grise<br>
            Track <- Track + BioCircosBackgroundTrack("Fond figure B",fillColors = "#f0eeef",maxRadius = 1.15,minRadius = 0.65,borderSize = 0)<br>
            <br>
            # On ajoute les anotations<br>
            Track <- Track +BioCircosTextTrack("PetitA","a",<br>
                                               x =q -0.03,y=-1.0625, size = "0.5em")<br>
            Track <- Track +BioCircosTextTrack("PetitB","b",<br>
                                               x = -0.03,y=-0.96, size = "0.5em")<br>
            Track <- Track +BioCircosTextTrack("PetitC","c",<br>
                                               x = -0.03,y=-0.85, size = "0.5em")<br>
            Track <- Track +BioCircosTextTrack("PetitD","d",<br>
                                               x = -0.03,y=-0.75, size = "0.5em")<br>
            Track <- Track +BioCircosTextTrack("PetitE","e",<br>
                                               x = -0.025,y=-0.70, size = "0.5em")<br>
            Track <- Track +BioCircosTextTrack("PetitF","f",<br>
                                               x = -0.0225,y=-0.65, size = "0.5em")<br>
            Projet_Antoine <- BioCircos(Track, genome = MyGenome,<br>
                                 genomeTicksDisplay = TRUE, genomeLabelDisplay = TRUE,<br>
                                 displayGenomeBorder = TRUE,<br>
                                 genomeTicksLen = 4,<br>
                                 genomeTicksScale = 5000000,<br>
                                 genomeTicksTextSize = "0.5em",<br>
                                 genomeLabelTextSize = "10",<br>
                                 genomeLabelDy = 10,<br>
                                 genomeBorderSize = 0, )</div></code>
        <h3>Afficher le résultat</h3>
        <code><div class="script">Circos <- BioCircos(Track, genome = MyGenome,<br>
            genomeTicksDisplay = TRUE, genomeLabelDisplay = TRUE,<br>
            displayGenomeBorder = TRUE,<br>
            genomeTicksLen = 4,<br>
            genomeTicksScale = 5000000,<br>
            genomeTicksTextSize = "0.5em",<br>
            genomeLabelTextSize = "10",<br>
            genomeLabelDy = 10,<br>
            genomeBorderSize = 0, )<br>
#Afficher le circos<br>
Circos</div></code>
        <h1 id="7">Résultat</h1>
        <img class="img-script" src="Visu Données Omics/Circos3/Circo3.png" alt="">
        
    </div>
<div class="zone_sommaire">
<div class="sommaire">
    <div class="plan-sommaire">
        <div class="zone-h3"><h3>Plan</h3></div>
        <div class="zone-texte">
            <ul>
                <li><a href="#1">Présentation Circos</a></li>
                <li><a href="#2">Présentation des données</a></li>
                <li><a href="#3">Présentation du script</a></li>
                <li><a href="#4">Les librairies</a></li>
                <li><a href="#5">Lecture des données</a></li>
                <li><a href="#6">Construction du circos</a></li>
                <li><a href="#7">Résultat</a></li>



            </ul>
        </div>

    </div>
</div>
</div>
</div>

</body>
</html>